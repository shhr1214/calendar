<%- model_class = Event -%>

<div class="row">
  <div class='col-lg-9'>
    <div class="page-header">
      <h1><%= @event.title %></h1>
    </div>

    <dl class="dl-horizontal">
      <dt><strong><%= model_class.human_attribute_name(:start_time) %>:</strong></dt>
      <dd><%= @event.start_time %></dd>
      <dt><strong><%= model_class.human_attribute_name(:end_time) %>:</strong></dt>
      <dd><%= @event.end_time %></dd>
      <dt><strong><%= model_class.human_attribute_name(:place) %>:</strong></dt>
      <dd><%= @event.place %></dd>
      <dt><strong><%= model_class.human_attribute_name(:description) %>:</strong></dt>
      <dd><%= @event.description %></dd>
      <dt><strong><%= model_class.human_attribute_name(:author_id) %>:</strong></dt>
      <dd><%= @event.author_id %></dd>
    </dl>

      <dl class="dl-horizontal">
        <p>
          <% participant = @event.participants.find_or_initialize_by(user: current_user) %>
          <%= form_for [@event, participant] do |f| %>
            <%= f.submit 'going', class: "btn btn-default" %>
            <%= f.submit 'interested', class: 'btn btn-default' %>
            <%= f.submit 'ignore', class: "btn btn-default" %>
          <% end %>
        </p>
        <div>
          <p>
            <%= link_to t('.back', default: t("helpers.links.back")),
                          events_path, class: 'btn btn-default'  %>
            <% if user_signed_in? && (current_user == @event.author || current_user.auth == :admin) %>
              <%= link_to t('.edit', default: t("helpers.links.edit")),
                            edit_event_path(@event), class: 'btn btn-default' %>
              <%= link_to t('.destroy', default: t("helpers.links.destroy")),
                            event_path(@event),
                            method: 'delete',
                            data: { confirm: t('.confirm', default: t("helpers.links.confirm", default: 'Are you sure?')) },
                            class: 'btn btn-danger' %>
          <% end %>
          </p>
        </div>
      </dl>
    </div>

  <div class="col-lg-3">
    <div class="well sidebar-nav">
      <% participant = @event.participants.find_or_initialize_by(user: current_user) %>
      <%= form_for [@event, participant] do |f| %>
      <ul class="nav nav-list">
        <p>
          <li><%= f.submit 'going', class: "btn btn-default btn-sm" %></li>
          <% @event.participants.with_participation(:going).each do |participant| %>
            <%= participant.user.name %>
          <% end %>
        </p>
        <p>
          <li><%= f.submit 'interested', class: 'btn btn-default btn-sm' %></li><br>
          <% @event.participants.with_participation(:interested).each do |participant| %>
            <%= participant.user.name %>
          <% end %>
        </p>
        <p>
          <li><%= f.submit 'ignore', class: "btn btn-default btn-sm" %></li><br>
          <% @event.participants.with_participation(:ignore).each do |participant| %>
            <%= participant.user.name %>
          <% end %>
        </p>
      <% end %>
      </ul>
    </div>
  </div>
</div>